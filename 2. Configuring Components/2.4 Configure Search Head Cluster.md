# Configure Search Head Cluster in Splunk

## Step 1: Enable Deployer

* Login to Management Server (Deployer) server using SSH

* Switch to the Splunk user and navigate to the system/local directory:
  
  Linux Command line -

  ***sudo su - splunk***
  ***cd /opt/solunk/etc/system/local/***

* Open server.conf for editing:
  
  Linux Command line -
  
  ***vi server.conf***

  <img width="812" height="408" alt="image" src="https://github.com/user-attachments/assets/b998641c-4813-4212-9ee5-4b89fc8e778b" />

* Add the following configuration to the file:
  
  Linux Command line -

  ***[shclustering]
  pass4SymmKey = SoftManiaSHClusterKey
  shcluster_label = shcluster1***

  <img width="812" height="872" alt="image" src="https://github.com/user-attachments/assets/17f78220-6ae6-4ffb-8e25-922c7260cab4" />

* Click "Shift" > : > "wq!"
  
* Restart the Deployer to apply changes:
  
  Linux Command line -
  
  ***/opt/splunk/bin/splunk restart***

  <img width="809" height="203" alt="image" src="https://github.com/user-attachments/assets/2cbbb120-85ba-4138-b1dd-7bcd1e2f4cd6" />

## Step 2: Configure Search Head Cluster members

### In Search Head 1 (SH1)
* Login to Search Head 1 (SH1) server using SSH
  
* Navigate to the bin folder:

  Linux Command Line -
  
  ***sudo su - splunk
     cd /opt/splunk/bin***
  
* Initialize SH1 as a member of the SH cluster:
  
  Linux Command Line -
  
  ***./splunk init shcluster-config -auth admin:YOUR_PASSWD -mgmt_uri https://YOUR_SH1_IP:8089 -replication_port 9000 -replication_factor 3 -conf_deploy_fetch_url https://YOUR_DEPLOYER_IP:8089 -secret SoftManiaSHClusterKey -shcluster_label shcluster1***

* Restart SH1:
  
  Linux Command Line -
  
  ***./splunk restart***

  <img width="811" height="550" alt="image" src="https://github.com/user-attachments/assets/49beae92-2bd9-4101-9db7-ce1fff86057f" />

### In Search Head 2 (SH2) and Search Head 3 (SH3)
* Follow the same steps as above to configure search head cluster in Search Head 1 & 2.

## Step 3: Bootstrap Search Head Cluster Election
* Login to Search Head 1 (SH1) server using SSH. Search Head 1 (SH1) will be the first cluster captain.

* Login as the Splunk user and navigate to the bin folder:
  
  Linux Command Line -
  
  ***sudo su - splunk
  cd /opt/splunk/bin***
  
* Execute the following command to bootstrap the cluster captain:
  
  Linux Command Line -
  
  ***./splunk bootstrap shcluster-captain -servers_list "https://YOUR_SH1_IP:8089,https://YOUR_SH2_IP:8089,https://YOUR_SH3_IP:8089" -auth admin:YOUR_SH1_PASSWORD***

* To check the status of the Search Head cluster from any member, run:
  
  Linux Command Line -
  
  ***./splunk show shcluster-status -auth admin:YOUR_SH_PASSWORD***

  <img width="818" height="875" alt="image" src="https://github.com/user-attachments/assets/b962382a-aefb-4fc2-b1e4-ac1e5fa3328e" />

* Successsfully built a Search Head Cluster by creating a Search Head Captain (SH1) and Search Heads 1 & 2
