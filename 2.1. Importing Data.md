# Splunk-ES-Personal

## 1. Importing Data
### 1.1 access.log log file
**Description:** Data Type: HTTP Access Logs | Description: Records data of requests processed by Web-Server such as 'canceling a subscription', 'purchasing a product', etc.

* Settings > Add Data
  
  ![image](https://github.com/user-attachments/assets/87c80793-f86a-4cc4-81d0-42581523411d)

* Add Data > Classify Source Type: access_combined > Splunk parser parses information appropiately for specificy sourcetype

  * Source Type: mandatory Splunk field that tells Splunk what kind of data contains the file so that it can format the data intelligently during indexing.
  * access_combined: NCSA combined format HTTP we server logs (can be generated by apache or other web servers)

    
  > KEY NOTE - Importance of Source Types: In Splunk, field extractions and regex are generally defined at the source types level. If source type of your log is incorrect, then it will not get parsed properly. Splunk comes with some built-in source types and it's associated regex for commong logs.
  
  <img width="953" alt="image" src="https://github.com/user-attachments/assets/2cdbc27b-f5ae-49da-acb1-625f49701d79" />

* Access.log data successfully uploaded
  <img width="943" alt="image" src="https://github.com/user-attachments/assets/55143c4f-7c24-400d-8ef3-1d3b237a3aa4" />

### 1.2 secure.log log file
**Description:** Data Type: Linux Authentication Logs | Description: Authenitcaiton Success & Failure Related Messages such as 'OS loging to your server', 'how many attempts made by an attacker', etc.

* Add Data > Classify Source Type: linux_secure > Splunk parser parses information appropiately for specific sourcetype

  * source type: linux_secure: format for the /var/log/secure file containing all security related messsaged on a Linux machine.
  > KEY NOTE - Importance of Source Types: In Splunk, field extractions and regex are generally defined at the source types level. If source type of your log is incorrect, then it will not get parsed properly. Splunk comes with some built-in source types and it's associated regex for commong logs.

  <img width="954" alt="image" src="https://github.com/user-attachments/assets/7a0d9fd1-a556-432e-8b8f-75014bdfc0c9" />

* secure.log data successfully uploaded
* However, some data has not been parsed appropiately.
  ![image](https://github.com/user-attachments/assets/e3fd4bc5-f084-48ea-8b9c-c8a65c34ec79)

* To fix this parsing issue, download 'Splunk Add-on for Unix and LInux' by going to Apps > Find more apps

  ![image](https://github.com/user-attachments/assets/773f211f-adbf-4d96-89f4-65a035034350)

  * Entire secure.log file is entirely getting parsed thanks to the installation of the add-on app.
  <img width="942" alt="image" src="https://github.com/user-attachments/assets/57382911-656a-4015-870a-0d421456bbbe" />

## 2. Importing Data Incorrectly
### 2.1 access.log log file
**Description:** Data Type: HTTP Access Logs | Description: Records data of requests processed by Web-Server such as 'canceling a subscription', 'purchasing a product', etc.

* Settings > Add Data

  ![image](https://github.com/user-attachments/assets/87c80793-f86a-4cc4-81d0-42581523411d)

* Select Source > Next
  
  ![image](https://github.com/user-attachments/assets/55c99dfd-56ed-4107-9f07-42cbe65a0b3e)

* Prior to selecting a Source Type, go to Settings > Source types where we will create our own source type

  ![image](https://github.com/user-attachments/assets/09aebd7a-0f48-41ec-a18e-1690e285bea5)

* Select 'New Source Type'

  ![image](https://github.com/user-attachments/assets/08a942f1-568a-49bb-8415-636c2ebf2c77)

* Create 'Source Type'

  ![image](https://github.com/user-attachments/assets/d09b73cd-5d58-42df-8930-e687fa317fc9)

* Return to prior page where you were uploading access.log file and select source type recently created

  ![image](https://github.com/user-attachments/assets/484162dc-fad8-413f-b30f-dd911576d5f6)

* Create a new index 'demosourcetype' and click 'Review'

  ![image](https://github.com/user-attachments/assets/ea30924e-2129-48d6-90d2-29b95c80da8d)

* Since the right sourcetype was not selected, not all fields were extracted correctly.
* transform.conf does not have the correct regex. If you would've selected 'access-combined' as the source type for access.log, the transform.conf would have the correct regex specifically for this type of log.

  ![image](https://github.com/user-attachments/assets/199ddfa7-e1f0-4d20-a099-c9dfc8fa8e4b)


## 3. Use-Case 1: Find Attack Vectors
### Requirements
* **SCOPE:** Compliance auditor requested to find certain attack vectors related to SSH Logins.

### 3.1 Find how many type of logins from every IPs.
![image](https://github.com/user-attachments/assets/02e36151-5504-4244-9d6a-58c1f0680276)

### 3.2 Find List of Countries from which the failed login attempts were made:
* SPL Command: iplocation
* SPL Command: source="secure.log" action=blocked | iplocation src
* Note: Field src showcases the ipaddress of where the attempt is being made from.

### 2.3 Create a visualization of countries in world map based on failed logins.
* SPL Command: source="secure.log" | iplocation src | geostats count by Country
* ![image](https://github.com/user-attachments/assets/ec115e91-9f27-4e21-876f-c7c2533675ef)
