# Configuring Indexer Discovery in Forwarders through Deployment Server

Reference: https://docs.splunk.com/Documentation/Splunk/9.4.0/Indexer/indexerdiscovery  

## Step 0: Enable Receiving on all Indexers
### Enable receiving on indexer 1
* Login to Indexer 1 via UI

* Select ***Settings*** > ***Forwarding and Receiving***
  <img width="958" height="283" alt="image" src="https://github.com/user-attachments/assets/2d6b1da1-6557-4780-9787-4efc4131d2ab" />

* Under "Receive data" >> Click on "Configure receiving" >> Click on "Add new."
  <img width="980" height="419" alt="image" src="https://github.com/user-attachments/assets/d9e3447d-d2bd-4516-9986-2b12be1d07ae" />

* Enter the TCP port (e.g., 9997) >> Click "Save."
  <img width="955" height="251" alt="image" src="https://github.com/user-attachments/assets/96f05816-2b0d-4365-aae5-4811968410a9" />

* The receiving port will be successfully configured on Indexer 1.
  <img width="1907" height="328" alt="image" src="https://github.com/user-attachments/assets/4b1134ab-af8d-461a-bcfe-7aa8fa836524" />

### Enable receiving on indexer 2 and indexer 3
* Repeat the same steps for Indexer 2 and Indexer 3.
  Indexer 2:
  <img width="1907" height="350" alt="image" src="https://github.com/user-attachments/assets/7ec81718-9afe-4a99-b150-1250fd7148a1" />

  Indexer 3:
  <img width="1908" height="366" alt="image" src="https://github.com/user-attachments/assets/9ba2acbe-cbc0-47d5-a780-14ec83df0386" />

## Step 1: Configure Indexer Discovery in Cluster Manager
* Login to Indexer Cluster Manager Server
  
* Access as a Splunk User
  Command Prompt:
  ***sudo su - splunk***

* Navigate to the system/local directory:
  ***cd /opt/splunk/etc/system/local/***

* Edit the server.conf file:
  Command Prompt -
  ***vi server.conf***

* Add the following configuration:
  Command Prompt - 
  [indexer_discovery]
  pass4SymmKey = admin123
  polling_rate = 10
  indexerWeightByDiskCapacity = true

* Restart Splunk to apply changes:
  Command Prompt -
  /opt/splunk/bin/splunk restart
  
  <img width="1025" height="495" alt="image" src="https://github.com/user-attachments/assets/eada320a-7ceb-4660-ac00-aab24311c775" />

## Step 2: Enable Indexer Discovery in Deployment Server
* Login to Deployment Server (Management Server)
  
* Login to the Splunk Component
  Command Prompt -
  ***sudo su - splunk***

* Navigate to the apps directory:
  Command Prompt -
  ***cd /opt/splunk/etc/apps***

* Create a new directory for the configuration:
  Command Prompt -
  ***mkdir ORG_general_infra_config***

* Navigate into the new directory:
  Command Prompt -
  ***cd ORG_general_infra_config***

* Create a local directory:
  Command Prompt -
  ***mkdir local***

* Navigate into the local directory:
  Command Prompt -
  ***cd local***

* Verify directory structure:
  Command Prompt -
  **ls**

* Edit the outputs.conf file:
  Command Prompt -
  ***vi outputs.conf***

* Add the following configuration:
  Command Prompt - 
  [indexer_discovery:manager1]
pass4SymmKey = YOUR_INDEXER_DISCOVERY_KEY
manager_uri = https://your_cluster_manager_ip:8089

[tcpout:group1]
autoLBFrequency = 30
forceTimebasedAutoLB = true
indexerDiscovery = manager1
useACK=true

[tcpout]
defaultGroup = group1


[indexAndForward]
index=true
selectiveIndexing=true 

* Command Prompt - :wq!
  
* Restart the server
  ***/opt/splunk/bin/splunk restart***

  <img width="1038" height="968" alt="image" src="https://github.com/user-attachments/assets/aecbd416-01c3-4c21-8c7e-9eee68be0eb0" />

## Step 3: Configure Deployment Server for Forwarders
* Login to Deployment Server (Management Server)
  Command Prompt -
  ***sudo su - splunk***

* Navigate to the deployment-apps directory:
  Command Prompt -
  ***cd /opt/splunk/etc/deployment-apps***

* Create a new directory for the configuration:
  Command Prompt -
  ***mkdir ORG_general_infra_config***

* Navigate into the new directory:
  Command Prompt -
  ***cd ORG_general_infra_config***

* Create a local directory:
  Command Prompt -
  ***mkdir local***

* Navigate into the local directory:
  Command Prompt -
  ***cd local***

* Verify directory structure:
  Command Prompt -
  ***ls***

* Edit the outputs.conf file:
  Command Prompt -
  ***vi outputs.conf***

* Add the following configuration:
  Command Prompt -
  [indexer_discovery:manager1]
  pass4SymmKey = YOUR_INDEXER_DISCOVERY_KEY
  manager_uri = https://your_cluster_manager_ip:8089

  [tcpout:group1]
  autoLBFrequency = 30
  forceTimebasedAutoLB = true
  indexerDiscovery = manager1
  useACK=true

  [tcpout]
  defaultGroup = group1

  <img width="1040" height="858" alt="image" src="https://github.com/user-attachments/assets/ff42635d-f691-436e-8118-8799d9a4abab" />
